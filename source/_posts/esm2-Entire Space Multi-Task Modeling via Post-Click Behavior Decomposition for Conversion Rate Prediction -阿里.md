---
title: esm2-Entire Space Multi-Task Modeling via Post-Click Behavior Decomposition for Conversion Rate Prediction -阿里
date: 2023-09-21 22:08:00
categories:
  - 排序模型
tags:
  - PostClick Behavior Decomposition
  - Conversion Rate Prediction
  - 多任务模型
  - ESMM 
  - 预估模型 
  - Recommender systems
description: 我们设计了一种新颖的深度推荐模型，名为精心制定的整个空间监督多任务模型（ESM2），采用多任务学习以并行预测一些分解的子目标，并将它们按顺序组合以构建最终的CVR。
cover: https://cdn.jsdelivr.net/gh/1oscar/image_house@main/2023-09-25_220750.png
---

## 摘要

作为现代电子商务的重要组成部分，推荐系统由两个基本模块组成，即点击率（CTR）和转化率（CVR）预测。虽然CVR对购买量有直接影响，但由于样本选择偏差（Sample Selection Bias，SSB）和数据稀疏性（Data Sparsity，DS）问题，其预测被广泛认为是具有挑战性的。尽管现有方法通常建立在用户的顺序行为路径“展示→点击→购买”上，用于处理SSB问题，但由于购买训练样本稀缺，它们仍然难以解决DS问题。观察到用户在点击后总是执行多个与购买相关的操作，

我们提出了一种新颖的后点击行为分解的想法。具体来说，**在点击和购买之间并行插入了不相交的与购买相关的确定性操作（DAction）和其他操作（OAction），形成了新颖的用户顺序行为图“展示→点击→D(O)Action→购买”**。

在这个图上定义模型能够利用整个空间的所有展示样本以及来自D(O)Action的额外丰富的监督信号，这将有效地解决SSB和DS问题。为此，

我们设计了一种新颖的深度推荐模型，名为精心制定的整个空间监督多任务模型（ESM2）。根据在图上定义的条件概率规则，它采用多任务学习以并行预测一些分解的子目标，并将它们按顺序组合以构建最终的CVR。
模型上表现出卓越
对离线和在线环境的广泛实验表明，ESM2在最先进的性能。源代码和数据集将被发布。


## RELATED WORK

我们提出的方法通过在整个空间中采用多任务学习框架，特别针对转化率预测问题。

因此，我们从以下两个方面简要回顾了最相关的工作：1) 转化率预测，和 2) 多任务学习。

**转化率预测**：

转化率预测是许多在线应用的关键组成部分，例如搜索引擎[2, 33]、推荐系统[10, 23]和在线广告[8, 12]。然而，关于CVR任务的文献很少[16, 28, 30]，尽管最近CTR方法[3, 29, 34, 35]取得了显著的发展。

实际上，CVR建模非常具有挑战性，因为转化是极为罕见的事件，只有极小部分的展示项目最终被点击和购买。

最近，深度神经网络由于其在特征表示和端到端建模方面的卓越能力，在包括推荐系统在内的许多领域取得了显著进展[4, 9, 13, 14, 17, 24]。

在本文中，我们也采用深度神经网络来模拟转化率预测任务。

与上述方法相反，我们基于后点击行为分解的新颖思想提出了一个新的用户顺序行为图“展示→点击→D(O)Action→购买”。

根据图上定义的条件概率规则，我们的网络结构专门设计用于并行预测多个分解的子目标，并将它们按顺序组合以构建最终的CVR。

**多任务学习**：

由于用户购买行为具有多阶段性质，例如展示、点击和购买，先前的工作尝试通过多任务学习框架来制定转化率预测任务。

例如，Hadash等人通过同时建模排名和评分预测任务，提出了基于多任务学习的推荐系统[11]。

Ma等人提出了一种名为多门混合专家的多任务学习方法，以明确从数据中学习任务关系[18]。

Gao等人提出了一个神经多任务推荐模型，以学习不同类型行为之间的级联关系[6]。

相反，我们通过与用户顺序行为图相关联，同时建模CTR和CVR任务，其中任务关系由条件概率明确定义（参见第3节）。

Ni等人提出通过跨多个任务学习通用用户表示以实现更有效的个性化[21]，我们也通过在不同任务之间共享嵌入特征来探索这样的思路。

最近，Ma等人提出了用于CVR预测的整个空间多任务模型（ESMM）[19]。它将CTR任务和CTCVR任务作为辅助任务添加到主要的CVR任务中。我们的方法在某种程度上受ESMM的启发，

但有以下显著差异：

我们提出了后点击行为分解的新颖思想，重新构建了一个新的用户顺序行为图“展示→点击→D(O)Action→购买”。

在这个图上定义模型可以同时制定最终的CVR以及一些辅助任务。它可以利用整个空间内的所有展示样本以及与购买行为高度相关的用户后点击行为的丰富监督信号，从而同时解决SSB和DS问题。


### model 

###  动机
在实际应用中，从一个物品被展示到成功购买之间，我们发现用户可能会选择多种顺序行为。

例如，在点击一个感兴趣的物品后，用户可以毫不犹豫地直接购买，或者将其添加到购物车，然后最终购买。

这些行为路径如图3(a)所示。我们可以根据预定义的特定与购买相关的后点击行为，例如添加到购物车（SCart）和添加到愿望列表（Wish），将这些路径进行简化和分组，如图3(b)所示。根据我们对在线真实世界日志数据的分析，我们发现只有1%的点击行为最终转化为购买行为，表明购买训练样本非常稀缺。

然而，与购买相比，购物车等几种后点击行为的数据量要大得多。例如，对于点击行为，有10%会被添加到购物车。

此外，这些后点击行为与最终的购买行为高度相关，

例如，在将它们添加到购物车（或愿望列表）后，有12%（或31%）最终会购买。在考虑它们与购买之间的高度相关性的情况下，我们如何利用更多的后点击行为数据以某种方式有利于CVR预测呢？

![](https://cdn.jsdelivr.net/gh/1oscar/image_house@main/2023-09-25_221612.png)


### 条件概率分解
在本节中，我们根据图3(c)中定义的有向图，介绍了CVR的条件概率分解以及相关辅助任务。首先，物品xi的后视点击率的概率，表示为p
，被定义为已被查看的情况下被点击的条件概率，描述了有向图中的路径“展示→点击”。在数学上，可以写成：

![](https://cdn.jsdelivr.net/gh/1oscar/image_house@main/2023-09-25_221725.png)

其中ci ∈ C表示第i个物品xi是否被点击，ci ∈ {0, 1}，C是所有被点击或未被点击的物品的标签空间，i ∈ [1, N]，N是物品数量。类似地，vi ∈ V表示第i个物品xi是否被查看（即展示），vi ∈ {0, 1}，V是所有被查看或未被查看的物品的标签空间。y1i是为了简化而使用的替代符号。


### 训练目标

我们使用S = {(ci，ai，bi；fi)} | i=1, N 表示训练集，其中 ci，ai，bi 表示第i个展示样本是否被点击、是否采取了确定性行动以及是否购买的真实标签。

然后，我们可以定义所有训练样本的联合后视点击率概率如下：

![](https://cdn.jsdelivr.net/gh/1oscar/image_house@main/2023-09-25_221923.png)



## 实验

为了评估提出的ESM2模型的有效性，我们在来自真实世界电子商务场景的离线数据集以及在线部署上进行了广泛的实验。

我们将ESM2与一些代表性的最先进方法进行比较，包括GBDT [5]、DNN [13]、使用过采样思想的DNN [22]和ESMM [18]。

首先，我们介绍了评估设置，包括数据集准备、评估指标、对这些最先进方法的简要描述以及实施细节。

然后，我们呈现了比较结果和分析。

接下来，我们进行了剔除研究，然后对不同的后点击行为进行了性能分析。


![](https://cdn.jsdelivr.net/gh/1oscar/image_house@main/2023-09-25_222046.png)


### 比较方法简要描述。以下是代表性的最先进方法的描述。

• GBDT [5]：梯度提升决策树（GBDT）模型遵循了梯度提升机（GBM）的思想，能够为回归和分类任务提供竞争力强、高度稳健和可解释性强的方法[28]。在本文中，我们将其用作非深度学习方法的代表。

• DNN [13]：我们还实现了一个深度神经网络基准模型，其结构和超参数与ESM2中的单一分支相同。与ESM2不同，它是使用“点击→购买”或“展示→点击”路径上的样本进行训练，以分别预测转化率p
cvr或点击率p
ct r。

• DNN-OS [22]：由于“展示→购买”和“点击→购买”路径上的数据稀缺，很难训练出具有良好泛化性能的深度神经网络。为解决这个问题，我们利用过采样策略在训练深度模型时增加正样本，称为DNN-OS。它与上述DNN模型具有相同的结构和超参数。

• ESMM [19]：为了公平比较，我们对ESMM使用了与上述深度模型相同的基础结构。ESMM直接对用户顺序路径“展示→点击→购买”上的转化率进行建模，而不考虑与购买相关的后点击行为。


![](https://cdn.jsdelivr.net/gh/1oscar/image_house@main/2023-09-25_222127.png)

至于F1分数，我们报告了通过为CVR和CTCVR分别设置不同阈值而获得的几个数值。

首先，我们根据预测的CVR或CTCVR得分将所有实例按降序排列。

然后，由于CVR任务的稀疏性（大约有1%的预测样本是正样本），

我们选择了三个阈值，分别是top@0.1%、top@0.6%和top@1%，以相应地将预测分为正样本和负样本组。

最后，我们计算了这些不同阈值下的预测的精确度、召回率和F1分数。结果总结在表4和表5中。可以观察到与表3类似的趋势。

再次，提出的方法ESM2在不同设置下取得了最佳性能。


![](https://cdn.jsdelivr.net/gh/1oscar/image_house@main/2023-09-25_222151.png)


![](https://cdn.jsdelivr.net/gh/1oscar/image_house@main/2023-09-25_222317.png)





## 结论

本文介绍了一种新颖的后点击行为分解思想，用于在电子商务推荐系统的背景下建模CVR任务。

我们构建了一个新颖的用户顺序行为图“展示→点击→D(O)Action→购买”，用于在整个空间上建模CVR。

基于条件概率规则，我们将CVR和一些相关的辅助任务，包括后视点击率、点击后DAction转化率和点击后转化率，分解为四个隐藏的概率变量，这些变量定义在图的明确子路径上。

因此，我们提出了一种新颖的深度神经推荐模型ESM2，通过采用多任务学习框架，同时预测CVR以及相关的辅助任务。

通过使用所有展示样本进行训练，并利用确定性后点击行为的丰富标签，我们的ESM2模型有效地解决了SSB和DS问题。

在离线和在线环境中进行的大量实验表明，ESM2在性能上优于最先进的模型。



## 原文link

https://arxiv.org/pdf/1910.07099.pdf

